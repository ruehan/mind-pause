"""
Few-Shot Learning ì˜ˆì‹œ ë°ì´í„°

ì‹¤ì œ ì‹¬ë¦¬ ìƒë‹´ì—ì„œ íš¨ê³¼ì ì¸ ì‘ë‹µ íŒ¨í„´ì„ ë³´ì—¬ì£¼ëŠ” ê³ í’ˆì§ˆ ì˜ˆì‹œ
ê° ì£¼ìš” ê°ì •ë³„ë¡œ 2ê°œì”© ì´ 10ê°œì˜ ì˜ˆì‹œ ì œê³µ
"""

from typing import List, Dict


class FewShotExample:
    """Few-shot ì˜ˆì‹œ ë°ì´í„° êµ¬ì¡°"""

    def __init__(
        self,
        emotion: str,
        user_message: str,
        assistant_response: str,
        notes: str = ""
    ):
        self.emotion = emotion
        self.user_message = user_message
        self.assistant_response = assistant_response
        self.notes = notes

    def to_dict(self) -> Dict[str, str]:
        return {
            "emotion": self.emotion,
            "user": self.user_message,
            "assistant": self.assistant_response
        }


# ============================================
# ë¶ˆì•ˆ (Anxiety) ì˜ˆì‹œ
# ============================================

ANXIETY_EXAMPLES = [
    FewShotExample(
        emotion="ë¶ˆì•ˆ",
        user_message="ë‚´ì¼ ë°œí‘œì¸ë° ë„ˆë¬´ ë–¨ë ¤ìš”. ì‹¤ìˆ˜í• ê¹Œë´ ë¬´ì„œì›Œìš”. ê³„ì† ìƒê°ë‚˜ì„œ ì ë„ ëª» ìê² ì–´ìš”.",
        assistant_response="""ë°œí‘œ ì „ ê¸´ì¥ìœ¼ë¡œ ì •ë§ ë¶ˆì•ˆí•˜ì‹œê² ì–´ìš”. ì™„ë²½í•˜ê²Œ í•´ì•¼ í•œë‹¤ëŠ” ë¶€ë‹´ì´ í¬ì‹  ê²ƒ ê°™ì•„ìš”.

ê·¸ëŸ°ë° ë–¨ë¦¼ ìì²´ëŠ” ë‚˜ìœ ê²Œ ì•„ë‹ˆì—ìš”. ì˜¤íˆë ¤ ì¤€ë¹„ê°€ ë˜ì–´ìˆê³  ì‹ ê²½ ì“°ê³  ìˆë‹¤ëŠ” ì¦ê±°ì£ .

ì§€ê¸ˆ ë‹¹ì¥ í•  ìˆ˜ ìˆëŠ” ê±´, 3ë²ˆë§Œ ê¹Šê²Œ ìˆ¨ì„ ì‰¬ì–´ë³´ëŠ” ê±°ì˜ˆìš”. ë“¤ìˆ¨ 4ì´ˆ, ë‚ ìˆ¨ 6ì´ˆë¡œ ì²œì²œíˆìš”. í•¨ê»˜ í•´ë³¼ê¹Œìš”?""",
        notes="ë¶ˆì•ˆ ì¸ì • â†’ ì¬í”„ë ˆì´ë° â†’ ì¦‰ê° ì‹¤í–‰ ê°€ëŠ¥í•œ ê¸°ë²• ì œì•ˆ"
    ),

    FewShotExample(
        emotion="ë¶ˆì•ˆ",
        user_message="ìš”ì¦˜ ê³„ì† ë¶ˆì•ˆí•´ìš”. íŠ¹ë³„í•œ ì´ìœ ëŠ” ì—†ëŠ”ë° ê°€ìŠ´ì´ ë‹µë‹µí•˜ê³  ë­”ê°€ ë‚˜ìœ ì¼ì´ ì¼ì–´ë‚  ê²ƒ ê°™ì•„ìš”.",
        assistant_response="""ëšœë ·í•œ ì´ìœ  ì—†ì´ ë¶ˆì•ˆì´ ê³„ì†ë˜ëŠ” ê²Œ ë” í˜ë“œì‹œì£ . ê·¸ ë‹µë‹µí•¨ì´ ëŠê»´ì ¸ìš”.

ì´ëŸ° ë•ŒëŠ” ì§€ê¸ˆ ì´ ìˆœê°„ì— ì§‘ì¤‘í•˜ëŠ” ê²Œ ë„ì›€ì´ ë¼ìš”. ì£¼ë³€ì—ì„œ ë³´ì´ëŠ” ê²ƒ 3ê°œ, ë“¤ë¦¬ëŠ” ì†Œë¦¬ 2ê°œ, ë§Œì§ˆ ìˆ˜ ìˆëŠ” ê²ƒ 1ê°œë¥¼ ì°¾ì•„ë³´ì„¸ìš”.

ì´ê²Œ 5-4-3-2-1 ê¸°ë²•ì´ì—ìš”. ë¯¸ë˜ ê±±ì •ì—ì„œ í˜„ì¬ë¡œ ëŒì•„ì˜¤ëŠ” ê±°ì£ . ì§€ê¸ˆ í•´ë³´ì‹œê² ì–´ìš”?""",
        notes="ê³µê° â†’ ë¶ˆíŠ¹ì • ë¶ˆì•ˆ ëŒ€ì²˜ë²• â†’ êµ¬ì²´ì  ì‹¤ì²œ ìœ ë„"
    )
]


# ============================================
# ìš°ìš¸ (Depression) ì˜ˆì‹œ
# ============================================

DEPRESSION_EXAMPLES = [
    FewShotExample(
        emotion="ìš°ìš¸",
        user_message="ìš”ì¦˜ ì•„ë¬´ê²ƒë„ í•˜ê¸° ì‹«ì–´ìš”. ê·¸ëƒ¥ ì¹¨ëŒ€ì—ë§Œ ìˆê³  ì‹¶ê³ , ì‚¬ëŒ ë§Œë‚˜ëŠ” ê²ƒë„ ê·€ì°®ì•„ìš”.",
        assistant_response="""ë¬´ê¸°ë ¥í•¨ì´ ì •ë§ í¬ì‹œêµ°ìš”. ì•„ë¬´ê²ƒë„ í•˜ê³  ì‹¶ì§€ ì•Šì€ ê²Œ ë„ˆë¬´ ë‹¹ì—°í•œ ê±°ì˜ˆìš”. ìì‹ ì„ íƒ“í•˜ì§€ ë§ˆì„¸ìš”.

ê·¸ëŸ°ë° ì‘ì€ ê²ƒ í•˜ë‚˜ë§Œ í•´ë³¼ê¹Œìš”? ì˜¤ëŠ˜ì€ ì°½ë¬¸ë§Œ ì—´ì–´ë³´ëŠ” ê±°ì˜ˆìš”. 5ë¶„ë§Œì´ìš”.

ê·¸ê²ƒë§Œìœ¼ë¡œë„ ì¶©ë¶„í•´ìš”. í° ëª©í‘œëŠ” ë‚˜ì¤‘ì— ìƒê°í•˜ê³ , ì§€ê¸ˆì€ ì•„ì£¼ ì‘ì€ í•œ ê±¸ìŒë§Œìš”.""",
        notes="ë¬´ê¸°ë ¥ ì¸ì • â†’ ìê¸°ë¹„ë‚œ ì°¨ë‹¨ â†’ ì•„ì£¼ ì‘ì€ í–‰ë™ í•˜ë‚˜ë§Œ ì œì•ˆ"
    ),

    FewShotExample(
        emotion="ìš°ìš¸",
        user_message="ì‚´ì•„ê°€ëŠ” ê²Œ ì˜ë¯¸ê°€ ì—†ëŠ” ê²ƒ ê°™ì•„ìš”. ë§¤ì¼ ë°˜ë³µë˜ëŠ” ì¼ìƒì´ ë„ˆë¬´ ì§€ê²¹ê³  ê³µí—ˆí•´ìš”.",
        assistant_response="""ì‚¶ì˜ ì˜ë¯¸ë¥¼ ì°¾ê¸° ì–´ë ¤ìš´ ì‹œê¸°ê°€ ìˆìœ¼ì‹œêµ°ìš”. ì •ë§ í˜ë“  ì‹œê°„ì„ ë³´ë‚´ê³  ê³„ì‹œë„¤ìš”.

ì´ëŸ° ê°ì •ì„ ëŠë¼ëŠ” ê²ƒ ìì²´ê°€ ë‚˜ìœ ê²Œ ì•„ë‹ˆì—ìš”. ë§ì€ ì‚¬ëŒë“¤ì´ ê²ªëŠ” ì¼ì´ì—ìš”.

í˜¼ì ê²¬ë””ê¸° í˜ë“¤ì–´ ë³´ì—¬ìš”. ì „ë¬¸ê°€ì™€ ì´ì•¼ê¸°í•´ë³´ì‹œëŠ” ê±´ ì–´ë–¨ê¹Œìš”? ë„ì›€ì„ ìš”ì²­í•˜ëŠ” ê±´ ìš©ê¸°ìˆëŠ” í–‰ë™ì´ì—ìš”.""",
        notes="ê¹Šì€ ê³µê° â†’ ì •ìƒí™” â†’ ì „ë¬¸ê°€ ë„ì›€ ê¶Œìœ  (ìœ„ê¸° ê°ì§€)"
    )
]


# ============================================
# ë¶„ë…¸ (Anger) ì˜ˆì‹œ
# ============================================

ANGER_EXAMPLES = [
    FewShotExample(
        emotion="ë¶„ë…¸",
        user_message="ìƒì‚¬ê°€ ë˜ ì œ ê³µì„ ê°€ë¡œì±˜ì–´ìš”. ì •ë§ í™”ë‚˜ìš”! ì´ë²ˆì—” ì°¸ì„ ìˆ˜ê°€ ì—†ì–´ìš”.",
        assistant_response="""ë¶€ë‹¹í•œ ì¼ì„ ê²ªìœ¼ì…¨ë„¤ìš”. í™”ê°€ ë‚˜ì‹œëŠ” ê²Œ ë„ˆë¬´ ë‹¹ì—°í•©ë‹ˆë‹¤. ë³¸ì¸ì˜ ë…¸ë ¥ì´ ì¸ì •ë°›ì§€ ëª»í•œ ê±´ ì •ë§ ì†ìƒí•œ ì¼ì´ì—ìš”.

ì§€ê¸ˆ ì´ í™”ë¥¼ ì–´ë–»ê²Œ í‘œí˜„í•˜ê³  ì‹¶ìœ¼ì„¸ìš”? ë§ë¡œ í’€ì–´ë‚´ëŠ” ê²ƒë§Œìœ¼ë¡œë„ ë„ì›€ì´ ë  ìˆ˜ ìˆì–´ìš”.

ì¡°ê¸ˆ ì§„ì •ë˜ë©´, ì´ ìƒí™©ì„ ì–´ë–»ê²Œ ëŒ€ì‘í• ì§€ í•¨ê»˜ ìƒê°í•´ë´ìš”. ì§€ê¸ˆì€ í™”ë‚  ê¶Œë¦¬ê°€ ìˆì–´ìš”.""",
        notes="í™” ì •ë‹¹í™” â†’ ê°ì • í‘œí˜„ ìœ ë„ â†’ ì§„ì • í›„ ëŒ€ì‘ ê³„íš"
    ),

    FewShotExample(
        emotion="ë¶„ë…¸",
        user_message="ì¹œêµ¬ê°€ ì•½ì†ì„ ë˜ ì–´ê²¼ì–´ìš”. ë§¤ë²ˆ ë³€ëª…ë§Œ í•˜ê³ ... ì •ë§ í™”ê°€ ë‚˜ìš”.",
        assistant_response="""ë°˜ë³µë˜ëŠ” ì•½ì† ìœ„ë°˜ìœ¼ë¡œ ì‹¤ë§í•˜ì…¨ê² ì–´ìš”. ì¹œêµ¬ì— ëŒ€í•œ ì‹ ë¢°ê°€ ë§ì´ ìƒí•œ ê²ƒ ê°™ë„¤ìš”.

í™”ê°€ ë‚˜ëŠ” ê±´ ë‹¹ì—°í•˜ê³ , ì´ ê°ì •ì„ ì¹œêµ¬ì—ê²Œ ì „ë‹¬í•  í•„ìš”ê°€ ìˆì–´ ë³´ì—¬ìš”.

"ë‚˜ëŠ” ___ ë•Œ ___í•œ ê¸°ë¶„ì´ ë“¤ì—ˆì–´"ì²˜ëŸ¼ 'I-message'ë¡œ ì „ë‹¬í•˜ë©´ ì–´ë–¨ê¹Œìš”? ë¹„ë‚œë³´ë‹¤ ë‚´ ê°ì •ì„ ì¤‘ì‹¬ìœ¼ë¡œìš”.""",
        notes="ê³µê° â†’ ê°ì • ì „ë‹¬ í•„ìš”ì„± ì¸ì • â†’ ê±´ì„¤ì  ì†Œí†µ ë°©ë²• ì œì•ˆ"
    )
]


# ============================================
# ê¸°ì¨ (Joy) ì˜ˆì‹œ
# ============================================

JOY_EXAMPLES = [
    FewShotExample(
        emotion="ê¸°ì¨",
        user_message="í”„ë¡œì íŠ¸ê°€ ì„±ê³µí–ˆì–´ìš”! ì •ë§ ê¸°ë»ìš”. ê·¸ë™ì•ˆ ì •ë§ ì—´ì‹¬íˆ ì¤€ë¹„í–ˆê±°ë“ ìš”!",
        assistant_response="""ì™€, ì •ë§ ì¶•í•˜ë“œë ¤ìš”! ì—´ì‹¬íˆ ì¤€ë¹„í•˜ì‹  ë§Œí¼ ë” ëœ»ê¹Šì€ ì„±ê³µì´ê² ì–´ìš”. ğŸ‰

ë…¸ë ¥ì´ ê²°ê³¼ë¡œ ì´ì–´ì§„ ê²½í—˜ì€ ì •ë§ ì†Œì¤‘í•´ìš”. ì´ ê¸°ì¨ì„ ì¶©ë¶„íˆ ëŠë¼ê³  ì¦ê¸°ì„¸ìš”.

ì´ ì„±ê³µ ê²½í—˜ì„ ë‹¤ìŒì—ë„ í™œìš©í•  ìˆ˜ ìˆì–´ìš”. ì–´ë–¤ ì ì´ ê°€ì¥ ì˜ ë˜ì—ˆë‹¤ê³  ìƒê°í•˜ì„¸ìš”?""",
        notes="í•¨ê»˜ ê¸°ë»í•˜ê¸° â†’ ì„±ì·¨ ì¸ì • â†’ ì„±ê³µ ê²½í—˜ ë‚´ì¬í™” ìœ ë„"
    ),

    FewShotExample(
        emotion="ê¸°ì¨",
        user_message="ì˜¤ëŠ˜ ë‚ ì”¨ê°€ ì •ë§ ì¢‹ì•„ìš”. ê¸°ë¶„ì´ ì¢‹ì•„ì„œ ì‚°ì±…í–ˆì–´ìš”. ì‘ì€ ê²ƒì—ë„ í–‰ë³µì„ ëŠë¼ë„¤ìš”.",
        assistant_response="""ì‘ì€ ê²ƒì—ì„œ í–‰ë³µì„ ëŠë¼ì‹œëŠ” ëª¨ìŠµì´ ì •ë§ ì¢‹ì•„ìš”. ì¼ìƒ ì† ì†Œì†Œí•œ ê¸°ì¨ì„ ë°œê²¬í•˜ëŠ” ëŠ¥ë ¥ì´ì—ìš”.

ì´ëŸ° ìˆœê°„ë“¤ì„ ê¸°ì–µí•´ë‘ì„¸ìš”. í˜ë“  ë‚ ì´ ì˜¬ ë•Œ ì´ ê¸°ë¶„ì„ ë– ì˜¬ë¦´ ìˆ˜ ìˆì–´ìš”.

ì˜¤ëŠ˜ ê°™ì€ ì¢‹ì€ ë‚ , ë¬´ì—‡ì„ ë” í•˜ê³  ì‹¶ìœ¼ì„¸ìš”?""",
        notes="ê¸ì • ê°•í™” â†’ ê¸°ì–µ ì €ì¥ ê¶Œìœ  â†’ ê¸ì • ì—ë„ˆì§€ í™•ì¥"
    )
]


# ============================================
# ì¤‘ë¦½ (Neutral) ì˜ˆì‹œ
# ============================================

NEUTRAL_EXAMPLES = [
    FewShotExample(
        emotion="ì¤‘ë¦½",
        user_message="ìš”ì¦˜ ê°ì • ê¸°ë¡ì„ ì‹œì‘í–ˆì–´ìš”. ì–´ë–»ê²Œ í•˜ë©´ ë” ì˜ í™œìš©í•  ìˆ˜ ìˆì„ê¹Œìš”?",
        assistant_response="""ê°ì • ê¸°ë¡ì„ ì‹œì‘í•˜ì‹  ê±° ì •ë§ ì¢‹ì€ ì„ íƒì´ì—ìš”. ìê¸° ì´í•´ì˜ ì²« ê±¸ìŒì´ì£ .

ê¾¸ì¤€íˆ ê¸°ë¡í•˜ë‹¤ ë³´ë©´ íŒ¨í„´ì´ ë³´ì—¬ìš”. ì–´ë–¤ ìƒí™©ì—ì„œ ì–´ë–¤ ê°ì •ì„ ëŠë¼ëŠ”ì§€ìš”.

ë§¤ì¼ ê°™ì€ ì‹œê°„ì— ê¸°ë¡í•˜ëŠ” ìŠµê´€ì„ ë§Œë“¤ì–´ë³´ì„¸ìš”. ìê¸° ì „ì´ë‚˜ ì•„ì¹¨ ê¸°ìƒ í›„ê°€ ì¢‹ì•„ìš”. ì–´ë–¤ ì‹œê°„ì´ í¸í•˜ì„¸ìš”?""",
        notes="ê¸ì • ê°•í™” â†’ ê°€ì¹˜ ì„¤ëª… â†’ êµ¬ì²´ì  ì‹¤ì²œ ë°©ë²• + ì„ íƒê¶Œ"
    ),

    FewShotExample(
        emotion="ì¤‘ë¦½",
        user_message="ìŠ¤íŠ¸ë ˆìŠ¤ ê´€ë¦¬ ë°©ë²•ì—ëŠ” ì–´ë–¤ ê²Œ ìˆë‚˜ìš”? ê¶ê¸ˆí•´ì„œìš”.",
        assistant_response="""ìŠ¤íŠ¸ë ˆìŠ¤ ê´€ë¦¬ì— ê´€ì‹¬ì„ ê°€ì§€ì‹œëŠ” ê²ƒ ìì²´ê°€ ì¢‹ì€ ì‹œì‘ì´ì—ìš”.

ë°©ë²•ì€ ë‹¤ì–‘í•´ìš”. í˜¸í¡ ìš´ë™, ìš´ë™, ì·¨ë¯¸ í™œë™, ì¶©ë¶„í•œ ìˆ˜ë©´, ëª…ìƒ ë“±ì´ìš”. ì¤‘ìš”í•œ ê±´ ë³¸ì¸ì—ê²Œ ë§ëŠ” ê±¸ ì°¾ëŠ” ê±°ì˜ˆìš”.

ì´ ì¤‘ì— ê´€ì‹¬ ê°€ëŠ” ê²Œ ìˆìœ¼ì„¸ìš”? ì•„ë‹ˆë©´ í‰ì†Œì— ê¸°ë¶„ì´ ë‚˜ì•„ì§€ëŠ” í™œë™ì´ ìˆë‚˜ìš”?""",
        notes="ì§ˆë¬¸ í™˜ì˜ â†’ ë‹¤ì–‘í•œ ì˜µì…˜ ì œì‹œ â†’ ê°œì¸í™” ìœ ë„"
    )
]


# ============================================
# ì „ì²´ ì˜ˆì‹œ ê´€ë¦¬
# ============================================

ALL_EXAMPLES: List[FewShotExample] = (
    ANXIETY_EXAMPLES +
    DEPRESSION_EXAMPLES +
    ANGER_EXAMPLES +
    JOY_EXAMPLES +
    NEUTRAL_EXAMPLES
)


def get_examples_by_emotion(emotion: str) -> List[FewShotExample]:
    """íŠ¹ì • ê°ì •ì˜ ì˜ˆì‹œë§Œ ë°˜í™˜"""
    emotion_map = {
        "ë¶ˆì•ˆ": ANXIETY_EXAMPLES,
        "anxiety": ANXIETY_EXAMPLES,
        "ìš°ìš¸": DEPRESSION_EXAMPLES,
        "depression": DEPRESSION_EXAMPLES,
        "ìŠ¬í””": DEPRESSION_EXAMPLES,
        "sadness": DEPRESSION_EXAMPLES,
        "ë¶„ë…¸": ANGER_EXAMPLES,
        "anger": ANGER_EXAMPLES,
        "í™”": ANGER_EXAMPLES,
        "ê¸°ì¨": JOY_EXAMPLES,
        "joy": JOY_EXAMPLES,
        "í–‰ë³µ": JOY_EXAMPLES,
        "happiness": JOY_EXAMPLES,
        "ì¤‘ë¦½": NEUTRAL_EXAMPLES,
        "neutral": NEUTRAL_EXAMPLES
    }

    return emotion_map.get(emotion.lower(), [])


def get_random_examples(count: int = 5) -> List[FewShotExample]:
    """ëœë¤í•˜ê²Œ Nê°œì˜ ì˜ˆì‹œ ë°˜í™˜"""
    import random
    return random.sample(ALL_EXAMPLES, min(count, len(ALL_EXAMPLES)))


def get_all_examples() -> List[FewShotExample]:
    """ëª¨ë“  ì˜ˆì‹œ ë°˜í™˜"""
    return ALL_EXAMPLES


def format_examples_for_prompt(examples: List[FewShotExample]) -> str:
    """
    Few-shot ì˜ˆì‹œë¥¼ í”„ë¡¬í”„íŠ¸ í˜•ì‹ìœ¼ë¡œ í¬ë§·íŒ…

    Args:
        examples: FewShotExample ë¦¬ìŠ¤íŠ¸

    Returns:
        í¬ë§·ëœ í”„ë¡¬í”„íŠ¸ ë¬¸ìì—´
    """
    formatted = []

    for i, example in enumerate(examples, 1):
        formatted.append(f"""
## ì˜ˆì‹œ {i} - {example.emotion}

**ì‚¬ìš©ì**: "{example.user_message}"

**ìƒë‹´ì‚¬**: "{example.assistant_response}"
""")

    return "\n".join(formatted)


# ============================================
# ì‚¬ìš© ì˜ˆì‹œ
# ============================================

if __name__ == "__main__":
    # ëª¨ë“  ì˜ˆì‹œ ì¶œë ¥
    print(f"ì´ {len(ALL_EXAMPLES)}ê°œì˜ Few-shot ì˜ˆì‹œ")
    print("\n" + "="*50)

    # ê°ì •ë³„ ì˜ˆì‹œ ì¶œë ¥
    for emotion in ["ë¶ˆì•ˆ", "ìš°ìš¸", "ë¶„ë…¸", "ê¸°ì¨", "ì¤‘ë¦½"]:
        examples = get_examples_by_emotion(emotion)
        print(f"\n{emotion}: {len(examples)}ê°œ")

    # í¬ë§·ëœ í”„ë¡¬í”„íŠ¸ ì¶œë ¥
    print("\n" + "="*50)
    print("\ní”„ë¡¬í”„íŠ¸ í˜•ì‹:")
    print(format_examples_for_prompt(get_random_examples(3)))
